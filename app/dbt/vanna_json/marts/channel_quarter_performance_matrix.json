{
  "name": "channel_quarter_performance_matrix",
  "description": "Analyzes marketing channel performance metrics for the most recent quarter (last 3 months of available data).\nThe model aggregates data with Channel as the primary dimension, Company as the secondary dimension,\nand further breaks down by Target Audience and Campaign Goal (represented by dimension_type and dimension_value).\nIt calculates key performance indicators (KPIs) like Conversion Rate, ROI, Acquisition Cost, and CTR for each combination.\nCrucially, it provides context by comparing these metrics against channel, company (within channel), dimension (within channel), and global averages.\nA weighted composite score is calculated to rank performance, along with a performance tier classification and a flag for top performers.\nThis model is designed to feed dashboards for channel mix analysis, ROI vs. cost comparisons, and detailed performance breakdowns.\n",
  "columns": [
    {
      "name": "Channel_Used",
      "type": "VARCHAR",
      "description": "The marketing channel used for the campaign (e.g., Facebook, Google Ads, Email).",
      "tests": [
        "not_null",
        "dbt_utils.unique_combination_of_columns",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "Company",
      "type": "VARCHAR",
      "description": "The company associated with the marketing campaign.",
      "tests": [
        "not_null",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "dimension_value",
      "type": "VARCHAR",
      "description": "The specific value of the dimension being analyzed (e.g., 'Brand Awareness', 'All Ages'). Corresponds to either Target_Audience or Campaign_Goal from stg_campaigns based on dimension_type.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "dimension_type",
      "type": "VARCHAR",
      "description": "Indicates whether the dimension_value represents a 'target_audience' or a 'goal'.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The total number of campaigns included in this specific channel-company-dimension combination for the quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_non_negative"
      ],
      "tags": []
    },
    {
      "name": "avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate for campaigns within this combination for the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "avg_roi",
      "type": "DOUBLE",
      "description": "The average Return on Investment (ROI) for campaigns within this combination for the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average cost to acquire a customer/lead for campaigns within this combination for the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_non_negative",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "avg_ctr",
      "type": "FLOAT",
      "description": "The average Click-Through Rate (CTR) for campaigns within this combination for the quarter (Total Clicks / Total Impressions).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "total_clicks",
      "type": "HUGEINT",
      "description": "The total number of clicks generated by campaigns in this combination for the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_non_negative",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "total_impressions",
      "type": "HUGEINT",
      "description": "The total number of impressions generated by campaigns in this combination for the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_non_negative",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "total_spend",
      "type": "DOUBLE",
      "description": "The total amount spent on campaigns in this combination for the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_non_negative",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "total_revenue",
      "type": "DOUBLE",
      "description": "Estimated total revenue generated from campaigns in this combination for the quarter (derived from spend and ROI).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "channel_avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate across all companies and dimensions for this specific channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "channel_avg_roi",
      "type": "DOUBLE",
      "description": "The average ROI across all companies and dimensions for this specific channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "channel_avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average acquisition cost across all companies and dimensions for this specific channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "channel_avg_ctr",
      "type": "DOUBLE",
      "description": "The average CTR across all companies and dimensions for this specific channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "channel_total_spend",
      "type": "DOUBLE",
      "description": "The total spend across all companies and dimensions for this specific channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "channel_total_revenue",
      "type": "DOUBLE",
      "description": "The total estimated revenue across all companies and dimensions for this specific channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "company_avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate for this specific company across all dimensions within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "company_avg_roi",
      "type": "DOUBLE",
      "description": "The average ROI for this specific company across all dimensions within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "company_avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average acquisition cost for this specific company across all dimensions within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "company_avg_ctr",
      "type": "DOUBLE",
      "description": "The average CTR for this specific company across all dimensions within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "company_total_spend",
      "type": "DOUBLE",
      "description": "The total spend for this specific company across all dimensions within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "company_total_revenue",
      "type": "DOUBLE",
      "description": "The total estimated revenue for this specific company across all dimensions within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "dimension_avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate for this specific dimension (goal or audience) across all companies within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "dimension_avg_roi",
      "type": "DOUBLE",
      "description": "The average ROI for this specific dimension (goal or audience) across all companies within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "dimension_avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average acquisition cost for this specific dimension (goal or audience) across all companies within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "dimension_avg_ctr",
      "type": "DOUBLE",
      "description": "The average CTR for this specific dimension (goal or audience) across all companies within this channel during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "global_avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The global average conversion rate across all channels, companies, and dimensions during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "global_avg_roi",
      "type": "DOUBLE",
      "description": "The global average ROI across all channels, companies, and dimensions during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "global_avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The global average acquisition cost across all channels, companies, and dimensions during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "global_avg_ctr",
      "type": "DOUBLE",
      "description": "The global average CTR across all channels, companies, and dimensions during the quarter.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_channel_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average conversion rate and the channel's average conversion rate. ((Avg / Channel Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "roi_vs_channel_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average ROI and the channel's average ROI. ((Avg / Channel Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_channel_avg",
      "type": "DOUBLE",
      "description": "Percentage difference measuring how much lower this combination's acquisition cost is compared to the channel average. ((Channel Avg / Avg) - 1). Positive means lower cost (better).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "ctr_vs_channel_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average CTR and the channel's average CTR. ((Avg / Channel Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_company_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average conversion rate and the company's average conversion rate within this channel. ((Avg / Company Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "roi_vs_company_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average ROI and the company's average ROI within this channel. ((Avg / Company Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_company_avg",
      "type": "DOUBLE",
      "description": "Percentage difference measuring how much lower this combination's acquisition cost is compared to the company average within this channel. ((Company Avg / Avg) - 1). Positive means lower cost (better).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "ctr_vs_company_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average CTR and the company's average CTR within this channel. ((Avg / Company Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_dimension_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average conversion rate and the dimension's average conversion rate within this channel. ((Avg / Dimension Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "roi_vs_dimension_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average ROI and the dimension's average ROI within this channel. ((Avg / Dimension Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_dimension_avg",
      "type": "DOUBLE",
      "description": "Percentage difference measuring how much lower this combination's acquisition cost is compared to the dimension average within this channel. ((Dimension Avg / Avg) - 1). Positive means lower cost (better).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "ctr_vs_dimension_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average CTR and the dimension's average CTR within this channel. ((Avg / Dimension Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_global_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average conversion rate and the global average conversion rate. ((Avg / Global Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "roi_vs_global_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average ROI and the global average ROI. ((Avg / Global Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_global_avg",
      "type": "DOUBLE",
      "description": "Percentage difference measuring how much lower this combination's acquisition cost is compared to the global average. ((Global Avg / Avg) - 1). Positive means lower cost (better).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "ctr_vs_global_avg",
      "type": "DOUBLE",
      "description": "Percentage difference between this combination's average CTR and the global average CTR. ((Avg / Global Avg) - 1).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "spend_pct_of_channel",
      "type": "DOUBLE",
      "description": "The percentage of the total channel spend allocated to this specific combination (Total Spend / Channel Total Spend).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "revenue_pct_of_channel",
      "type": "DOUBLE",
      "description": "The percentage of the total channel revenue contributed by this specific combination (Total Revenue / Channel Total Revenue).",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "composite_score",
      "type": "DOUBLE",
      "description": "A weighted score reflecting overall performance relative to global averages. Weights: ROI (0.4), Conversion Rate (0.25), Acquisition Cost (0.25, inverted), CTR (0.1). Higher is better.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_non_negative",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    },
    {
      "name": "performance_tier",
      "type": "VARCHAR",
      "description": "Categorizes performance based on the composite score: 'high_performer' (>=1.2), 'low_performer' (<=0.8), 'average_performer' (between 0.8 and 1.2).",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "is_top_performer",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this combination ranks in the top 10% based on composite score within its dimension type (goal or target_audience).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_of_type"
      ],
      "tags": []
    }
  ],
  "tags": []
}