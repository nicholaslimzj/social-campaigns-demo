{
  "name": "top_bottom_performers",
  "description": "Mart model that identifies the top and bottom performing entities (companies, channels, segments) based on key marketing metrics like conversion rate, ROI, acquisition cost, and CTR. It calculates average metrics per entity, ranks them, and compares them against global averages. Company metrics are based on data from the last three available months in the source.",
  "columns": [
    {
      "name": "dimension",
      "type": "VARCHAR",
      "description": "The dimension being analyzed (e.g., 'company', 'channel', 'segment').",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "entity",
      "type": "VARCHAR",
      "description": "The specific entity within the dimension being ranked (e.g., company name, channel name, customer segment name).",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "metric",
      "type": "VARCHAR",
      "description": "The performance metric being evaluated (e.g., 'conversion_rate', 'roi', 'acquisition_cost', 'ctr').",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "value",
      "type": "DOUBLE",
      "description": "The calculated value of the metric for the specific entity. This is typically an average (conversion rate, ROI, acquisition cost) or an overall calculation (CTR).",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "rank",
      "type": "BIGINT",
      "description": "The rank of the entity for the specified metric within its dimension. Rank 1 indicates the best performance (highest for conversion rate/ROI/CTR, lowest for acquisition cost).",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "total_entities",
      "type": "BIGINT",
      "description": "The total number of unique entities within the dimension (e.g., total number of companies analyzed).",
      "tests": [
        "not_null",
        "dbt_utils.expression_is_true"
      ],
      "tags": []
    },
    {
      "name": "performance",
      "type": "VARCHAR",
      "description": "Indicates whether the entity is a 'top' or 'bottom' performer for the given metric.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "global_avg",
      "type": "DOUBLE",
      "description": "The global average value for the specified metric across all entities in all dimensions, calculated from the stg_campaigns data.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "pct_diff_from_avg",
      "type": "DOUBLE",
      "description": "The percentage difference between the entity's metric value and the global average for that metric. Calculated as (value / global_avg) - 1.",
      "tests": [],
      "tags": []
    }
  ],
  "tags": []
}