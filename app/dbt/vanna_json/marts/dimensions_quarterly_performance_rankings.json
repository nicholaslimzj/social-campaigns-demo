{
  "name": "dimensions_quarterly_performance_rankings",
  "description": "Ranks entities (companies, channels, customer segments) within their respective dimensions based on key performance metrics (Conversion Rate, ROI, Acquisition Cost, CTR) for the most recent quarter. Includes quarter-over-quarter (QoQ) comparison against the previous quarter, calculating percentage changes and identifying performance trends (improved, declined, unchanged). Designed for performance ranking dashboards and QoQ analysis.",
  "columns": [
    {
      "name": "dimension",
      "type": "VARCHAR",
      "description": "The category or dimension being analyzed (e.g., 'company', 'channel', 'segment'). This defines the group within which entities are ranked.",
      "tests": [
        "not_null",
        "accepted_values",
        "dbt_utils.unique_combination_of_columns"
      ],
      "tags": []
    },
    {
      "name": "entity",
      "type": "VARCHAR",
      "description": "The specific item within the dimension being ranked (e.g., a specific company name, channel name like 'Instagram', or customer segment name).",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "metric",
      "type": "VARCHAR",
      "description": "The specific performance metric being measured for the entity (e.g., 'conversion_rate', 'roi', 'acquisition_cost', 'ctr').",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "metric_value",
      "type": "DOUBLE",
      "description": "The calculated value of the specified metric for the entity in the current quarter (e.g., average conversion rate, average ROI).",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "metric_rank",
      "type": "BIGINT",
      "description": "The rank of the entity within its dimension for the specified metric in the current quarter (1 = best performance). Note: Lower rank (closer to 1) is better for 'acquisition_cost', while higher rank is better for others.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "total_entities",
      "type": "BIGINT",
      "description": "The total number of unique entities within the dimension for which the ranking is calculated in the current quarter.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The number of campaigns associated with this entity that contributed to the metrics in the current quarter.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "prev_metric_value",
      "type": "DOUBLE",
      "description": "The calculated value of the specified metric for the entity in the *previous* quarter. NULL if the entity had no data in the previous quarter.",
      "tests": [],
      "tags": []
    },
    {
      "name": "metric_qoq_change",
      "type": "DOUBLE",
      "description": "The percentage change in the metric value from the previous quarter to the current quarter ((current - previous) / previous). For Acquisition Cost, the calculation reflects improvement: ((previous - current) / previous). NULL if previous quarter data is unavailable.",
      "tests": [],
      "tags": []
    },
    {
      "name": "trend",
      "type": "VARCHAR",
      "description": "Indicates the performance trend based on the QoQ change: 'improved', 'declined', 'unchanged', or 'no_previous_data'. 'Improved' means higher Conversion Rate/ROI/CTR or lower Acquisition Cost.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "current_window_start_month",
      "type": "BIGINT",
      "description": "The starting month number (1-12) of the current quarter analysis window.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "current_window_end_month",
      "type": "BIGINT",
      "description": "The ending month number (1-12) of the current quarter analysis window.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "previous_window_start_month",
      "type": "BIGINT",
      "description": "The starting month number (1-12) of the previous quarter analysis window.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "previous_window_end_month",
      "type": "BIGINT",
      "description": "The ending month number (1-12) of the previous quarter analysis window.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    }
  ],
  "tags": []
}