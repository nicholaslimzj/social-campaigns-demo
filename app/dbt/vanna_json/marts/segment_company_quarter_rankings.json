{
  "name": "segment_company_quarter_rankings",
  "description": "Ranks companies within each customer segment based on key performance metrics (Conversion Rate, ROI, Acquisition Cost, CTR) for the current quarter (last 3 months of available data).\nThis model identifies top-performing companies for specific segments, calculates relative performance against segment and global averages, and provides context like campaign counts and total companies per segment.\nIt is intended for use in dashboards related to Segment Performance Rankings, Company-Segment Affinity analysis, and Targeting Strategy recommendations.\n",
  "columns": [
    {
      "name": "Customer_Segment",
      "type": "VARCHAR",
      "description": "The customer segment the company's performance is being evaluated within.",
      "tests": [
        "not_null",
        "dbt_utils.unique_combination_of_columns"
      ],
      "tags": []
    },
    {
      "name": "Company",
      "type": "VARCHAR",
      "description": "The company being ranked within the customer segment.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate for the company within this segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "avg_roi",
      "type": "DOUBLE",
      "description": "The average Return on Investment (ROI) for the company within this segment for the current quarter.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average cost to acquire a customer for the company within this segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_non_negative"
      ],
      "tags": []
    },
    {
      "name": "overall_ctr",
      "type": "FLOAT",
      "description": "The overall Click-Through Rate (CTR) calculated as total clicks divided by total impressions for the company within this segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The total number of campaigns run by the company within this segment during the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_rank",
      "type": "BIGINT",
      "description": "The rank of the company within the segment based on average conversion rate (descending - 1 is best).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "roi_rank",
      "type": "BIGINT",
      "description": "The rank of the company within the segment based on average ROI (descending - 1 is best).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_rank",
      "type": "BIGINT",
      "description": "The rank of the company within the segment based on average acquisition cost (ascending - 1 is best).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "ctr_rank",
      "type": "BIGINT",
      "description": "The rank of the company within the segment based on overall CTR (descending - 1 is best).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "total_companies_per_segment",
      "type": "BIGINT",
      "description": "The total number of unique companies evaluated within this customer segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "is_top_conversion_company",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this company has the highest average conversion rate (rank 1) in the segment.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "is_top_roi_company",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this company has the highest average ROI (rank 1) in the segment.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "is_top_acquisition_cost_company",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this company has the lowest average acquisition cost (rank 1) in the segment.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "is_top_ctr_company",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this company has the highest overall CTR (rank 1) in the segment.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "segment_avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate across all companies within this specific segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "segment_avg_roi",
      "type": "DOUBLE",
      "description": "The average ROI across all companies within this specific segment for the current quarter.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "segment_avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average acquisition cost across all companies within this specific segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_non_negative"
      ],
      "tags": []
    },
    {
      "name": "segment_avg_ctr",
      "type": "DOUBLE",
      "description": "The average overall CTR across all companies within this specific segment for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "company_count",
      "type": "BIGINT",
      "description": "The distinct count of companies within this segment (should match total_companies_per_segment).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive",
        "dbt_expectations.expect_column_values_to_equal_column"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_segment_avg",
      "type": "DOUBLE",
      "description": "The company's average conversion rate performance relative to the segment average (Company Avg / Segment Avg - 1). Positive means better than segment average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_segment_avg",
      "type": "DOUBLE",
      "description": "The company's average ROI performance relative to the segment average (Company Avg / Segment Avg - 1). Positive means better than segment average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_segment_avg",
      "type": "DOUBLE",
      "description": "The company's average acquisition cost performance relative to the segment average (Segment Avg / Company Avg - 1). Positive means better (lower cost) than segment average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_segment_avg",
      "type": "DOUBLE",
      "description": "The company's overall CTR performance relative to the segment average (Company Avg / Segment Avg - 1). Positive means better than segment average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_global_avg",
      "type": "DOUBLE",
      "description": "The company's average conversion rate performance relative to the global average across all segments (Company Avg / Global Avg - 1). Positive means better than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_global_avg",
      "type": "DOUBLE",
      "description": "The company's average ROI performance relative to the global average across all segments (Company Avg / Global Avg - 1). Positive means better than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_global_avg",
      "type": "DOUBLE",
      "description": "The company's average acquisition cost performance relative to the global average across all segments (Global Avg / Company Avg - 1). Positive means better (lower cost) than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_global_avg",
      "type": "DOUBLE",
      "description": "The company's overall CTR performance relative to the global average across all segments (Company Avg / Global Avg - 1). Positive means better than global average.",
      "tests": [],
      "tags": []
    }
  ],
  "tags": []
}