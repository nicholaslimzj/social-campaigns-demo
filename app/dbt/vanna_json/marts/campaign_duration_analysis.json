{
  "name": "campaign_duration_analysis",
  "description": "Analyzes the relationship between campaign duration and performance metrics (ROI, Conversion Rate, CTR, etc.).\nIt identifies optimal campaign durations overall and for specific combinations of goals, segments, and channels based on maximizing ROI.\nThe model provides three types of analysis outputs distinguished by the 'analysis_type' column:\n1. 'optimal_durations': Recommends the best duration bucket for different dimensions.\n2. 'exact_duration_performance': Shows average performance metrics for each exact campaign duration (in days) for trend analysis.\n3. 'roi_impact_analysis': Compares the actual ROI of campaigns within specific goal/segment/channel/duration groups against the potential ROI if the optimal duration had been used.\nThis mart model aggregates data from stg_campaigns and uses statistical summaries to derive insights without external ML libraries.\n",
  "columns": [
    {
      "name": "analysis_type",
      "type": "VARCHAR",
      "description": "Type of analysis presented in the row: 'optimal_durations', 'exact_duration_performance', or 'roi_impact_analysis'.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "dimension",
      "type": "VARCHAR",
      "description": "The dimension for which the optimal duration is calculated (e.g., 'Overall', 'Goal', 'Segment', 'Channel', 'Goal-Segment', 'Goal-Channel'). Populated only when analysis_type = 'optimal_durations'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "category",
      "type": "VARCHAR",
      "description": "The specific category within the dimension (e.g., 'All', 'Product Launch', 'High Value', 'Email', 'Product Launch - High Value'). Populated only when analysis_type = 'optimal_durations'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "optimal_duration_bucket",
      "type": "VARCHAR",
      "description": "The duration range identified as having the highest average ROI for the given dimension and category (e.g., '15-21 days'). Populated only when analysis_type = 'optimal_durations'.",
      "tests": [
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "optimal_min_duration",
      "type": "BIGINT",
      "description": "The minimum duration (in days) included in the optimal duration bucket. Populated only when analysis_type = 'optimal_durations'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "optimal_max_duration",
      "type": "BIGINT",
      "description": "The maximum duration (in days) included in the optimal duration bucket. Populated only when analysis_type = 'optimal_durations'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "optimal_roi",
      "type": "DOUBLE",
      "description": "The average Return on Investment (ROI) achieved within the optimal duration bucket for the given dimension/category. Populated only when analysis_type = 'optimal_durations'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "optimal_conversion_rate",
      "type": "DOUBLE",
      "description": "The average Conversion Rate achieved within the optimal duration bucket for the given dimension/category. Populated only when analysis_type = 'optimal_durations'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "optimal_roi_per_day",
      "type": "DOUBLE",
      "description": "The average ROI per day achieved within the optimal duration bucket, normalizing ROI by duration length. Populated only when analysis_type = 'optimal_durations'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "optimal_duration_range",
      "type": "VARCHAR",
      "description": "A formatted string representing the optimal duration range (e.g., '15-21 days'). Derived from optimal_min_duration and optimal_max_duration. Populated only when analysis_type = 'optimal_durations'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "Duration",
      "type": "BIGINT",
      "description": "The exact campaign duration in days. Populated only when analysis_type = 'exact_duration_performance'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The number of campaigns aggregated in this row. Represents campaigns within a duration bucket/dimension (for optimal_durations), campaigns with an exact duration (for exact_duration_performance), or campaigns within a specific goal/segment/channel/duration group (for roi_impact_analysis). Note: Aggregations typically require >= 3 campaigns based on HAVING clauses.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "avg_conversion_rate",
      "type": "DOUBLE",
      "description": "Average conversion rate for campaigns with the specific 'Duration'. Populated only when analysis_type = 'exact_duration_performance'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "avg_roi",
      "type": "DOUBLE",
      "description": "Average ROI for campaigns with the specific 'Duration'. Populated only when analysis_type = 'exact_duration_performance'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "Average Acquisition Cost for campaigns with the specific 'Duration'. Populated only when analysis_type = 'exact_duration_performance'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "avg_ctr",
      "type": "FLOAT",
      "description": "Average Click-Through Rate (CTR) for campaigns with the specific 'Duration'. Populated only when analysis_type = 'exact_duration_performance'.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "avg_roi_per_day",
      "type": "DOUBLE",
      "description": "Average ROI per day for campaigns with the specific 'Duration'. Populated only when analysis_type = 'exact_duration_performance'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "goal",
      "type": "VARCHAR",
      "description": "The campaign goal associated with the ROI impact analysis. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "segment",
      "type": "VARCHAR",
      "description": "The customer segment associated with the ROI impact analysis. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "channel",
      "type": "VARCHAR",
      "description": "The marketing channel associated with the ROI impact analysis. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "duration_bucket",
      "type": "VARCHAR",
      "description": "The duration bucket that the campaigns fell into for this specific goal/segment/channel combination. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "optimal_bucket_for_goal_segment",
      "type": "VARCHAR",
      "description": "The optimal duration bucket identified specifically for this goal-segment combination. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "optimal_bucket_for_goal_channel",
      "type": "VARCHAR",
      "description": "The optimal duration bucket identified specifically for this goal-channel combination. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "actual_roi",
      "type": "DOUBLE",
      "description": "The actual average ROI achieved by campaigns in this specific goal/segment/channel/duration_bucket group. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "optimal_roi_for_goal_segment",
      "type": "DOUBLE",
      "description": "The optimal ROI identified for this specific goal-segment combination (from the 'optimal_durations' analysis). Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "optimal_roi_for_goal_channel",
      "type": "DOUBLE",
      "description": "The optimal ROI identified for this specific goal-channel combination (from the 'optimal_durations' analysis). Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "potential_roi_improvement_goal_segment",
      "type": "DOUBLE",
      "description": "The difference between the optimal ROI (for goal-segment) and the actual ROI achieved. Represents potential uplift. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "potential_roi_improvement_goal_channel",
      "type": "DOUBLE",
      "description": "The difference between the optimal ROI (for goal-channel) and the actual ROI achieved. Represents potential uplift. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "pct_improvement_goal_segment",
      "type": "DOUBLE",
      "description": "The potential percentage ROI improvement if the optimal duration bucket for the goal-segment combination had been used. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "pct_improvement_goal_channel",
      "type": "DOUBLE",
      "description": "The potential percentage ROI improvement if the optimal duration bucket for the goal-channel combination had been used. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [],
      "tags": []
    },
    {
      "name": "is_using_optimal_duration_goal_segment",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating TRUE if the 'duration_bucket' for this group matches the 'optimal_bucket_for_goal_segment'. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "is_using_optimal_duration_goal_channel",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating TRUE if the 'duration_bucket' for this group matches the 'optimal_bucket_for_goal_channel'. Populated only when analysis_type = 'roi_impact_analysis'.",
      "tests": [
        "accepted_values"
      ],
      "tags": []
    }
  ],
  "tags": []
}