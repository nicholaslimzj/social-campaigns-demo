{
  "name": "campaign_quarter_clusters",
  "description": "Identifies high-performing campaign combinations (Goal, Segment, Channel, Duration) for the current quarter (last 3 months).\nIt calculates average performance metrics for each combination, ranks them based on a composite score (weighted towards ROI and Conversion Rate),\ndetermines the optimal duration range for each Goal-Segment-Channel group, and flags the top 10% performing combinations per company as 'winning combinations'.\nThis model supports dashboard sections related to winning campaign strategies and optimization recommendations.\nIt uses SQL-based aggregation and ranking to simulate clustering analysis.\n",
  "columns": [
    {
      "name": "Company",
      "type": "VARCHAR",
      "description": "The company associated with the campaign combination.",
      "tests": [
        "not_null",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "goal",
      "type": "VARCHAR",
      "description": "The primary objective of the campaigns in this combination (e.g., 'Increase Sales', 'Brand Awareness'). Derived from stg_campaigns.Campaign_Goal.",
      "tests": [
        "not_null",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "segment",
      "type": "VARCHAR",
      "description": "The target customer segment for the campaigns in this combination (e.g., 'Fashion', 'Electronics'). Derived from stg_campaigns.Customer_Segment.",
      "tests": [
        "not_null",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "channel",
      "type": "VARCHAR",
      "description": "The marketing channel used for the campaigns in this combination (e.g., 'Facebook', 'Instagram'). Derived from stg_campaigns.Channel_Used.",
      "tests": [
        "not_null",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "duration_bucket",
      "type": "VARCHAR",
      "description": "The duration range category for the campaigns in this combination (e.g., '1-7 days', '15-21 days').",
      "tests": [
        "not_null",
        "accepted_values",
        "dbt_utils.unique_combination_of_columns"
      ],
      "tags": []
    },
    {
      "name": "avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate achieved by campaigns within this specific combination for the quarter.",
      "tests": [
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "avg_roi",
      "type": "DOUBLE",
      "description": "The average Return on Investment (ROI) generated by campaigns within this specific combination for the quarter.",
      "tests": [
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average cost to acquire a customer through campaigns within this specific combination for the quarter.",
      "tests": [
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "avg_ctr",
      "type": "FLOAT",
      "description": "The average Click-Through Rate (Clicks / Impressions) for campaigns within this specific combination for the quarter.",
      "tests": [
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The number of individual campaigns included in this combination for the quarter. Only combinations with >= 3 campaigns are included.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "min_duration",
      "type": "BIGINT",
      "description": "The minimum duration (in days) among campaigns within this combination.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "max_duration",
      "type": "BIGINT",
      "description": "The maximum duration (in days) among campaigns within this combination.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "avg_duration",
      "type": "DOUBLE",
      "description": "The average duration (in days) of campaigns within this combination.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_company",
      "type": "DOUBLE",
      "description": "Ratio of this combination's average conversion rate compared to the company's overall average conversion rate for the quarter. > 1 indicates better than company average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_company",
      "type": "DOUBLE",
      "description": "Ratio of this combination's average ROI compared to the company's overall average ROI for the quarter. > 1 indicates better than company average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_company",
      "type": "DOUBLE",
      "description": "Ratio of the company's overall average acquisition cost compared to this combination's average acquisition cost for the quarter. > 1 indicates lower (better) cost than company average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_company",
      "type": "DOUBLE",
      "description": "Ratio of this combination's average CTR compared to the company's overall average CTR for the quarter. > 1 indicates better than company average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_global",
      "type": "DOUBLE",
      "description": "Ratio of this combination's average conversion rate compared to the global average conversion rate across all companies for the quarter. > 1 indicates better than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_global",
      "type": "DOUBLE",
      "description": "Ratio of this combination's average ROI compared to the global average ROI across all companies for the quarter. > 1 indicates better than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_global",
      "type": "DOUBLE",
      "description": "Ratio of the global average acquisition cost compared to this combination's average acquisition cost for the quarter. > 1 indicates lower (better) cost than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_global",
      "type": "DOUBLE",
      "description": "Ratio of this combination's average CTR compared to the global average CTR across all companies for the quarter. > 1 indicates better than global average.",
      "tests": [],
      "tags": []
    },
    {
      "name": "conversion_rate_rank",
      "type": "BIGINT",
      "description": "Rank of this combination within the company based on average conversion rate (descending). 1 is best.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "roi_rank",
      "type": "BIGINT",
      "description": "Rank of this combination within the company based on average ROI (descending). 1 is best.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_rank",
      "type": "BIGINT",
      "description": "Rank of this combination within the company based on average acquisition cost (ascending). 1 is best (lowest cost).",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "ctr_rank",
      "type": "BIGINT",
      "description": "Rank of this combination within the company based on average CTR (descending). 1 is best.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "composite_rank",
      "type": "BIGINT",
      "description": "Overall rank of this combination within the company based on the weighted composite score (ascending). 1 is the best overall combination.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "composite_score",
      "type": "DECIMAL(24,1)",
      "description": "A weighted score calculated from individual metric ranks (ROI: 40%, Conversion Rate: 30%, Acquisition Cost: 20%, CTR: 10%). Lower score is better.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "optimal_duration_bucket",
      "type": "VARCHAR",
      "description": "The duration bucket identified as having the highest average ROI for this specific Company, Goal, Segment, and Channel combination.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "optimal_min_duration",
      "type": "BIGINT",
      "description": "The minimum duration (in days) associated with the optimal duration bucket for this Company, Goal, Segment, and Channel.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "optimal_max_duration",
      "type": "BIGINT",
      "description": "The maximum duration (in days) associated with the optimal duration bucket for this Company, Goal, Segment, and Channel.",
      "tests": [
        "not_null",
        "dbt_utils.accepted_range"
      ],
      "tags": []
    },
    {
      "name": "is_winning_combination",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this combination ranks within the top 10% based on the composite score for its company.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "is_optimal_duration",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this combination's duration bucket matches the identified optimal duration bucket for its Company, Goal, Segment, and Channel.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "optimal_duration_range",
      "type": "VARCHAR",
      "description": "A formatted string representing the optimal duration range (e.g., '15-21 days') based on the highest ROI for the Company, Goal, Segment, and Channel.",
      "tests": [
        "not_null"
      ],
      "tags": []
    }
  ],
  "tags": []
}