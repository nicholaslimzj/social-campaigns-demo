{
  "name": "campaign_historical_performance_matrix",
  "description": "This mart model creates a performance matrix that cross-tabulates campaign goals against customer segments\nusing all historical campaign data from stg_campaigns. It identifies optimal targeting strategies by calculating\nkey performance metrics (Conversion Rate, ROI, Acquisition Cost, CTR) for each goal-segment combination.\nThe model provides multi-dimensional performance comparisons (vs. goal average, segment average, global average),\nranks combinations, and implements a weighted composite scoring system to highlight top performers.\nIt is designed to support dashboards visualizing the campaign performance matrix and providing optimization recommendations.\n",
  "columns": [
    {
      "name": "goal",
      "type": "VARCHAR",
      "description": "The specific objective of the marketing campaigns (e.g., 'Product Launch', 'Increase Sales'). This dimension forms one axis of the performance matrix.",
      "tests": [
        "not_null",
        "relationships",
        "dbt_utils.unique_combination_of_columns"
      ],
      "tags": []
    },
    {
      "name": "segment",
      "type": "VARCHAR",
      "description": "The customer segment targeted by the marketing campaigns (e.g., 'Technology', 'Fashion'). This dimension forms the other axis of the performance matrix.",
      "tests": [
        "not_null",
        "relationships"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The total number of historical campaigns run for this specific goal and segment combination.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_non_negative"
      ],
      "tags": []
    },
    {
      "name": "avg_conversion_rate",
      "type": "DOUBLE",
      "description": "The average conversion rate achieved across all campaigns for this goal-segment combination. Calculated as the average of individual campaign conversion rates.",
      "tests": [],
      "tags": []
    },
    {
      "name": "avg_roi",
      "type": "DOUBLE",
      "description": "The average Return on Investment (ROI) achieved across all campaigns for this goal-segment combination. Calculated as the average of individual campaign ROIs.",
      "tests": [],
      "tags": []
    },
    {
      "name": "avg_acquisition_cost",
      "type": "DOUBLE",
      "description": "The average cost to acquire a customer (Acquisition Cost) across all campaigns for this goal-segment combination. Calculated as the average of individual campaign acquisition costs.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_non_negative"
      ],
      "tags": []
    },
    {
      "name": "avg_ctr",
      "type": "FLOAT",
      "description": "The average Click-Through Rate (CTR) across all campaigns for this goal-segment combination. Calculated as SUM(Clicks) / SUM(Impressions) for the group.",
      "tests": [
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_goal_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average conversion rate compared to the average conversion rate for all campaigns with the same goal (expressed as percentage difference, e.g., 0.1 means 10% better).",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_goal_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average ROI compared to the average ROI for all campaigns with the same goal (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_goal_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average acquisition cost compared to the average acquisition cost for all campaigns with the same goal (expressed as percentage difference). Note: Higher values indicate better performance (lower cost relative to average).",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_goal_avg",
      "type": "FLOAT",
      "description": "Relative performance of this combination's average CTR compared to the average CTR for all campaigns with the same goal (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_segment_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average conversion rate compared to the average conversion rate for all campaigns targeting the same segment (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_segment_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average ROI compared to the average ROI for all campaigns targeting the same segment (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_segment_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average acquisition cost compared to the average acquisition cost for all campaigns targeting the same segment (expressed as percentage difference). Note: Higher values indicate better performance (lower cost relative to average).",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_segment_avg",
      "type": "FLOAT",
      "description": "Relative performance of this combination's average CTR compared to the average CTR for all campaigns targeting the same segment (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "conversion_rate_vs_global_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average conversion rate compared to the global average conversion rate across all campaigns (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "roi_vs_global_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average ROI compared to the global average ROI across all campaigns (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "acquisition_cost_vs_global_avg",
      "type": "DOUBLE",
      "description": "Relative performance of this combination's average acquisition cost compared to the global average acquisition cost across all campaigns (expressed as percentage difference). Note: Higher values indicate better performance (lower cost relative to average).",
      "tests": [],
      "tags": []
    },
    {
      "name": "ctr_vs_global_avg",
      "type": "FLOAT",
      "description": "Relative performance of this combination's average CTR compared to the global average CTR across all campaigns (expressed as percentage difference).",
      "tests": [],
      "tags": []
    },
    {
      "name": "conversion_rate_rank",
      "type": "BIGINT",
      "description": "Overall rank of this goal-segment combination based on average conversion rate (1 = highest conversion rate).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_rank_within_goal",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average conversion rate, compared only to other combinations with the same goal (1 = highest conversion rate within the goal).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_rank_within_segment",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average conversion rate, compared only to other combinations targeting the same segment (1 = highest conversion rate within the segment).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "roi_rank",
      "type": "BIGINT",
      "description": "Overall rank of this goal-segment combination based on average ROI (1 = highest ROI).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "roi_rank_within_goal",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average ROI, compared only to other combinations with the same goal (1 = highest ROI within the goal).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "roi_rank_within_segment",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average ROI, compared only to other combinations targeting the same segment (1 = highest ROI within the segment).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_rank",
      "type": "BIGINT",
      "description": "Overall rank of this goal-segment combination based on average acquisition cost (1 = lowest acquisition cost).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_rank_within_goal",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average acquisition cost, compared only to other combinations with the same goal (1 = lowest acquisition cost within the goal).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_rank_within_segment",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average acquisition cost, compared only to other combinations targeting the same segment (1 = lowest acquisition cost within the segment).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "ctr_rank",
      "type": "BIGINT",
      "description": "Overall rank of this goal-segment combination based on average CTR (1 = highest CTR).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "ctr_rank_within_goal",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average CTR, compared only to other combinations with the same goal (1 = highest CTR within the goal).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "ctr_rank_within_segment",
      "type": "BIGINT",
      "description": "Rank of this goal-segment combination based on average CTR, compared only to other combinations targeting the same segment (1 = highest CTR within the segment).",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_positive"
      ],
      "tags": []
    },
    {
      "name": "conversion_rate_score",
      "type": "DOUBLE",
      "description": "Normalized score (0-1) based on the overall conversion rate rank. Higher score indicates better relative performance.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "roi_score",
      "type": "DOUBLE",
      "description": "Normalized score (0-1) based on the overall ROI rank. Higher score indicates better relative performance.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "acquisition_cost_score",
      "type": "DOUBLE",
      "description": "Normalized score (0-1) based on the overall acquisition cost rank (lower cost = higher score). Higher score indicates better relative performance.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "ctr_score",
      "type": "DOUBLE",
      "description": "Normalized score (0-1) based on the overall CTR rank. Higher score indicates better relative performance.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "composite_score",
      "type": "DOUBLE",
      "description": "A weighted score combining the normalized scores for conversion rate (30%), ROI (40%), acquisition cost (20%), and CTR (10%). Higher score indicates better overall performance based on these weights.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "is_high_conversion",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if the average conversion rate for this combination is significantly (e.g., >10%) higher than the global average.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "is_high_roi",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if the average ROI for this combination is significantly (e.g., >10%) higher than the global average.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "is_cost_efficient",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if the average acquisition cost for this combination is significantly (e.g., >10%) better (lower) than the global average. Note: Based on inverted comparison `acquisition_cost_vs_global_avg > 0.1`.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "is_high_engagement",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if the average CTR for this combination is significantly (e.g., >10%) higher than the global average.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "is_top_performer",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if this goal-segment combination ranks within the top 10% based on the composite score.",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "is_untested_combination",
      "type": "BOOLEAN",
      "description": "Boolean flag indicating if there were no historical campaigns run for this specific goal and segment combination (campaign_count = 0).",
      "tests": [
        "not_null"
      ],
      "tags": []
    }
  ],
  "tags": []
}