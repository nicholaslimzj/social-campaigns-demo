{
  "name": "dimensions_quarter_performance_rankings",
  "description": "Ranks entities (companies, channels, segments, target audiences) within their respective dimensions based on key performance metrics (Conversion Rate, ROI, Acquisition Cost, CTR) for the most recent quarter.\nCalculates quarter-over-quarter (QoQ) changes and identifies performance trends (improved/declined/unchanged).\nThe 'current quarter' is defined as the last 3 months of available data in the source, and the 'previous quarter' is the 3 months preceding that.\nThis model unpivots the metrics for easier analysis and dashboard integration.\nBuilt from `stg_campaigns`.\n",
  "columns": [
    {
      "name": "dimension",
      "type": "VARCHAR",
      "description": "The dimension being analyzed (e.g., 'company', 'channel', 'segment', 'audience').",
      "tests": [
        "not_null",
        "accepted_values",
        "dbt_utils.unique_combination_of_columns"
      ],
      "tags": []
    },
    {
      "name": "entity",
      "type": "VARCHAR",
      "description": "The specific entity within the dimension being ranked (e.g., a specific company name, channel name, segment name, or audience group).",
      "tests": [
        "not_null"
      ],
      "tags": []
    },
    {
      "name": "metric",
      "type": "VARCHAR",
      "description": "The performance metric being measured (e.g., 'conversion_rate', 'roi', 'acquisition_cost', 'ctr').",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "metric_value",
      "type": "DOUBLE",
      "description": "The calculated value of the metric for the entity in the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_non_negative"
      ],
      "tags": []
    },
    {
      "name": "metric_rank",
      "type": "BIGINT",
      "description": "The rank of the entity within its dimension for the specific metric in the current quarter. Lower rank is better for acquisition_cost, higher rank is better for others.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "total_entities",
      "type": "BIGINT",
      "description": "The total number of unique entities within the dimension for the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "campaign_count",
      "type": "BIGINT",
      "description": "The number of campaigns associated with this entity within the dimension during the current quarter.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "prev_metric_value",
      "type": "DOUBLE",
      "description": "The calculated value of the metric for the entity in the previous quarter. NULL if no data exists for the previous quarter.",
      "tests": [],
      "tags": []
    },
    {
      "name": "metric_qoq_change",
      "type": "DOUBLE",
      "description": "The percentage change in the metric value from the previous quarter to the current quarter. Calculated as (current - previous) / previous, except for acquisition cost where improvement is negative change. NULL if no previous data.",
      "tests": [],
      "tags": []
    },
    {
      "name": "trend",
      "type": "VARCHAR",
      "description": "Indicates the performance trend based on the QoQ change ('improved', 'declined', 'unchanged', 'no_previous_data'). Note: 'improved' for acquisition_cost means the value decreased.",
      "tests": [
        "not_null",
        "accepted_values"
      ],
      "tags": []
    },
    {
      "name": "current_window_start_month",
      "type": "BIGINT",
      "description": "The starting month number (1-12) of the current 3-month analysis window.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "current_window_end_month",
      "type": "BIGINT",
      "description": "The ending month number (1-12) of the current 3-month analysis window.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "previous_window_start_month",
      "type": "BIGINT",
      "description": "The starting month number (1-12) of the previous 3-month analysis window used for comparison.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    },
    {
      "name": "previous_window_end_month",
      "type": "BIGINT",
      "description": "The ending month number (1-12) of the previous 3-month analysis window used for comparison.",
      "tests": [
        "not_null",
        "dbt_expectations.expect_column_values_to_be_between"
      ],
      "tags": []
    }
  ],
  "tags": []
}