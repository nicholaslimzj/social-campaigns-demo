version: 2

models:
  - name: stg_campaigns
    description: "Staging model for marketing campaign data. Reads raw campaign performance data from Parquet files, including base attributes and derived performance metrics like CTR, CPC, and ROAS. This model serves as the foundation for downstream campaign analysis."
    config:
      materialized: view
      tags: ['staging']
    columns:
      - name: Campaign_ID
        description: "Unique identifier for the marketing campaign."
        data_type: BIGINT
        tests:
          - not_null
          - unique

      - name: Target_Audience
        description: "Description of the intended audience demographic for the campaign (e.g., 'Women 45-60', 'All Ages')."
        data_type: VARCHAR
        tests:
          - not_null

      - name: Campaign_Goal
        description: "The primary objective of the campaign (e.g., 'Product Launch', 'Brand Awareness', 'Increase Sales')."
        data_type: VARCHAR
        tests:
          - not_null
          - accepted_values:
              values: ['Product Launch', 'Brand Awareness', 'Increase Sales'] # Based on sample data

      - name: Duration
        description: "The length of the campaign, likely in days."
        data_type: BIGINT
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: Channel_Used
        description: "The marketing channel used for the campaign (e.g., 'Pinterest', 'Twitter', 'Instagram')."
        data_type: VARCHAR
        tests:
          - not_null
          - accepted_values:
              values: ['Pinterest', 'Twitter', 'Instagram'] # Based on sample data

      - name: Conversion_Rate
        description: "The rate at which interactions resulted in a desired action (e.g., purchase, sign-up), expressed as a decimal."
        data_type: DOUBLE
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: Acquisition_Cost
        description: "The cost associated with acquiring a customer or achieving the campaign goal through this campaign."
        data_type: DOUBLE
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: ROI
        description: "Return On Investment for the campaign, calculated based on revenue and cost."
        data_type: DOUBLE
        tests:
          - not_null

      - name: Location
        description: "The geographical location targeted or associated with the campaign."
        data_type: VARCHAR
        tests:
          - not_null

      - name: Language
        description: "The primary language used in the campaign materials."
        data_type: VARCHAR
        tests:
          - not_null
          - accepted_values:
              values: ['English', 'French'] # Based on sample data

      - name: Clicks
        description: "The total number of clicks generated by the campaign."
        data_type: BIGINT
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: Impressions
        description: "The total number of times the campaign ad was displayed."
        data_type: BIGINT
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: Engagement_Score
        description: "A metric indicating the level of user interaction with the campaign content."
        data_type: DOUBLE
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0 # Assuming engagement cannot be negative

      - name: Customer_Segment
        description: "The specific customer segment targeted by the campaign (e.g., 'Fashion')."
        data_type: VARCHAR
        tests:
          - not_null
          - accepted_values:
              values: ['Fashion'] # Based on sample data

      - name: Date
        description: "The original date associated with the campaign data record."
        data_type: TIMESTAMP_NS
        tests:
          - not_null

      - name: Company
        description: "The company running the marketing campaign."
        data_type: VARCHAR
        tests:
          - not_null
          - accepted_values:
              values: ['Attire Artistry'] # Based on sample data

      - name: CTR
        description: "Derived Metric: Click-Through Rate (Clicks / Impressions)."
        data_type: FLOAT # Note: Sample data shows FLOAT, but derived type might vary
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: CPC
        description: "Derived Metric: Cost Per Click (Acquisition_Cost / Clicks)."
        data_type: DOUBLE
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0

      - name: ROAS
        description: "Derived Metric: Return On Ad Spend."
        data_type: DOUBLE
        tests:
          - not_null
          # ROAS can theoretically be negative if costs exceed revenue, so no min_value test applied unless business rules dictate otherwise.

      - name: StandardizedDate
        description: "Derived Field: Standardized date value derived from the original 'Date' field, potentially cleaned or truncated."
        data_type: TIMESTAMP_NS
        tests:
          - not_null